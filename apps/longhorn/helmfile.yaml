environments:
  default:
    secrets:
      - ../globals.sops.yaml
---
repositories:
  - name: longhorn
    url: git+https://github.com/longhorn/charts@charts?ref=8771f25551803596f1f928bd93c49ccc85396c74 # FIXME: temp workaround

releases:
  - name: longhorn
    chart: longhorn/longhorn
    version: 1
    values:
      - ingress:
          enabled: true
          host: longhorn.{{ .Values.domain }}
          annotations:
            traefik.ingress.kubernetes.io/router.entrypoints: websecure
            traefik.ingress.kubernetes.io/router.middlewares: kube-system-traefik-forward-auth-nanak8s@kubernetescrd
  - name: longhorn-extras
    chart: ../../charts/longhorn-extras
