environments:
  default:
    secrets:
      - ../globals.sops.yaml
      - default.sops.yaml
---
repositories:
  - name: cnpg
    url: https://cloudnative-pg.github.io/charts

releases:
  - name: cnpg
    chart: cnpg/cloudnative-pg
    version: 0.20.0
  - name: cnpg-backup-s3
    chart: ../../charts/cnpg-backup-s3
    values:
      - image:
          repository: rclone/rclone
          tag: 1.65.0 # FIXME:
      - sftp:
          host: sftpgo-sftp.sftpgo
          port: 2022
          username: "{{ .Values.sftp.username }}"
          obscuredPassword: "{{ .Values.sftp.obscuredPassword }}"
          path: /
      - auth:
          accessKey: "{{ .Values.cnpg.s3.accessKey }}"
          secretKey: "{{ .Values.cnpg.s3.secretKey }}"
