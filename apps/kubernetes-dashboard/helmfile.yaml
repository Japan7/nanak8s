environments:
  default:
    secrets:
      - ../globals.sops.yaml
---
repositories:
  - name: kubernetes-dashboard
    url: https://kubernetes.github.io/dashboard/

releases:
  - name: kubernetes-dashboard
    chart: kubernetes-dashboard/kubernetes-dashboard
    version: 7.0.2
    values:
      - nginx:
          enabled: false
      - cert-manager:
          enabled: false
      - app:
          ingress:
            issuer:
              name: foobar
    strategicMergePatches:
      - apiVersion: networking.k8s.io/v1
        kind: Ingress
        metadata:
          name: kubernetes-dashboard
          annotations:
            traefik.ingress.kubernetes.io/router.entrypoints: websecure
        spec:
          ingressClassName:
          rules:
            - host: dash.{{ .Values.domain }}
              http:
                paths:
                  - pathType: Prefix
                    path: /
                    backend:
                      service:
                        name: kubernetes-dashboard
                        port:
                          number: 443
          tls:
  - name: kubernetes-dashboard-extras
    chart: ../../charts/kubernetes-dashboard-extras
